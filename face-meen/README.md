# Face Recognition System

à¸£à¸°à¸šà¸šà¸ˆà¸”à¸ˆà¸³à¹ƒà¸šà¸«à¸™à¹‰à¸²à¹‚à¸”à¸¢à¹ƒà¸Šà¹‰ **ArcFace** (Python Backend) + **Next.js** (Frontend) à¸à¸£à¹‰à¸­à¸¡à¹€à¸à¹‡à¸šà¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¹ƒà¸™ JSON

## ğŸ—ï¸ à¸ªà¸–à¸²à¸›à¸±à¸•à¸¢à¸à¸£à¸£à¸¡

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        Frontend                              â”‚
â”‚                      (Next.js + React)                       â”‚
â”‚                                                              â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚   â”‚   Register   â”‚  â”‚    Verify    â”‚  â”‚    Users     â”‚      â”‚
â”‚   â”‚     Page     â”‚  â”‚     Page     â”‚  â”‚     List     â”‚      â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚ HTTP API
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        Backend                               â”‚
â”‚                       (FastAPI)                              â”‚
â”‚                                                              â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚   â”‚ Face Service â”‚  â”‚   Storage    â”‚  â”‚  REST API    â”‚      â”‚
â”‚   â”‚  (ArcFace)   â”‚  â”‚   (JSON)     â”‚  â”‚  Endpoints   â”‚      â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ“‹ à¸„à¸§à¸²à¸¡à¸•à¹‰à¸­à¸‡à¸à¸²à¸£

### Backend
- Python 3.9+
- pip

### Frontend
- Node.js 18+
- npm

## ğŸš€ à¸à¸²à¸£à¸•à¸´à¸”à¸•à¸±à¹‰à¸‡à¹à¸¥à¸°à¸£à¸±à¸™

### 1. Backend

```bash
# à¹€à¸‚à¹‰à¸²à¹‚à¸Ÿà¸¥à¹€à¸”à¸­à¸£à¹Œ backend
cd backend

# à¸ªà¸£à¹‰à¸²à¸‡ virtual environment
python -m venv venv

# Activate virtual environment
# macOS/Linux:
source venv/bin/activate
# Windows:
# .\venv\Scripts\activate

# à¸•à¸´à¸”à¸•à¸±à¹‰à¸‡ dependencies
pip install -r requirements.txt

# à¸£à¸±à¸™ server
uvicorn main:app --reload --host 0.0.0.0 --port 8000
```

> âš ï¸ **à¸«à¸¡à¸²à¸¢à¹€à¸«à¸•à¸¸**: à¸„à¸£à¸±à¹‰à¸‡à¹à¸£à¸à¸—à¸µà¹ˆà¸£à¸±à¸™ InsightFace à¸ˆà¸°à¹‚à¸«à¸¥à¸” model files (~500MB)

### 2. Frontend

```bash
# à¹€à¸›à¸´à¸” terminal à¹ƒà¸«à¸¡à¹ˆà¹à¸¥à¸°à¹€à¸‚à¹‰à¸²à¹‚à¸Ÿà¸¥à¹€à¸”à¸­à¸£à¹Œ frontend
cd frontend

# à¸•à¸´à¸”à¸•à¸±à¹‰à¸‡ dependencies
npm install

# à¸£à¸±à¸™ dev server
npm run dev
```

à¹€à¸›à¸´à¸” http://localhost:3000 à¹ƒà¸™à¹€à¸šà¸£à¸²à¸§à¹Œà¹€à¸‹à¸­à¸£à¹Œ

## ğŸ“¡ API Endpoints

| Method | Endpoint | à¸„à¸³à¸­à¸˜à¸´à¸šà¸²à¸¢ |
|--------|----------|----------|
| POST | `/register` | à¸¥à¸‡à¸—à¸°à¹€à¸šà¸µà¸¢à¸™à¹ƒà¸šà¸«à¸™à¹‰à¸²à¹ƒà¸«à¸¡à¹ˆ |
| POST | `/verify` | à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸šà¸•à¸±à¸§à¸•à¸™à¸ˆà¸²à¸à¹ƒà¸šà¸«à¸™à¹‰à¸² |
| GET | `/users` | à¸£à¸²à¸¢à¸Šà¸·à¹ˆà¸­à¸œà¸¹à¹‰à¹ƒà¸Šà¹‰à¸—à¸µà¹ˆà¸¥à¸‡à¸—à¸°à¹€à¸šà¸µà¸¢à¸™ |
| DELETE | `/users/{user_id}` | à¸¥à¸šà¸œà¸¹à¹‰à¹ƒà¸Šà¹‰à¸­à¸­à¸à¸ˆà¸²à¸à¸£à¸°à¸šà¸š |
| GET | `/health` | à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸šà¸ªà¸–à¸²à¸™à¸° API |

### à¸•à¸±à¸§à¸­à¸¢à¹ˆà¸²à¸‡à¸à¸²à¸£à¹ƒà¸Šà¹‰à¸‡à¸²à¸™

#### Register
```bash
curl -X POST http://localhost:8000/register \
  -H "Content-Type: application/json" \
  -d '{
    "user_id": "u001",
    "name": "Tanakit",
    "image_base64": "data:image/jpeg;base64,..."
  }'
```

#### Verify
```bash
curl -X POST http://localhost:8000/verify \
  -H "Content-Type: application/json" \
  -d '{
    "image_base64": "data:image/jpeg;base64,..."
  }'
```

## âš™ï¸ à¸à¸²à¸£à¸•à¸±à¹‰à¸‡à¸„à¹ˆà¸²

### Backend (.env)
```env
MATCH_THRESHOLD=0.45  # Cosine similarity threshold à¸ªà¸³à¸«à¸£à¸±à¸š matching
```

### Frontend (.env.local)
```env
NEXT_PUBLIC_API_URL=http://localhost:8000
```

## ğŸ“ à¹‚à¸„à¸£à¸‡à¸ªà¸£à¹‰à¸²à¸‡à¹‚à¸›à¸£à¹€à¸ˆà¸„

```
face-meen/
â”œâ”€â”€ backend/
â”‚   â”œâ”€â”€ main.py              # FastAPI application
â”‚   â”œâ”€â”€ face_service.py      # ArcFace embedding service
â”‚   â”œâ”€â”€ storage.py           # JSON storage with file locking
â”‚   â”œâ”€â”€ requirements.txt     # Python dependencies
â”‚   â”œâ”€â”€ .env                 # Environment variables
â”‚   â””â”€â”€ faces.json           # Face embeddings data (auto-created)
â”‚
â””â”€â”€ frontend/
    â”œâ”€â”€ app/
    â”‚   â”œâ”€â”€ layout.tsx       # Root layout
    â”‚   â”œâ”€â”€ page.tsx         # Home page
    â”‚   â”œâ”€â”€ register/
    â”‚   â”‚   â””â”€â”€ page.tsx     # Register page
    â”‚   â”œâ”€â”€ verify/
    â”‚   â”‚   â””â”€â”€ page.tsx     # Verify page
    â”‚   â””â”€â”€ users/
    â”‚       â””â”€â”€ page.tsx     # Users list page
    â”œâ”€â”€ components/
    â”‚   â”œâ”€â”€ Camera.tsx       # Camera component
    â”‚   â””â”€â”€ Navbar.tsx       # Navigation bar
    â”œâ”€â”€ lib/
    â”‚   â””â”€â”€ api.ts           # API client
    â””â”€â”€ .env.local           # Environment variables
```

## ğŸ”’ à¸‚à¹‰à¸­à¸„à¸§à¸£à¸à¸´à¸ˆà¸²à¸£à¸“à¸²à¸”à¹‰à¸²à¸™à¸„à¸§à¸²à¸¡à¸›à¸¥à¸­à¸”à¸ à¸±à¸¢

1. **Embeddings à¹€à¸›à¹‡à¸™à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸­à¹ˆà¸­à¸™à¹„à¸«à¸§** - à¸„à¸§à¸£à¸ˆà¸³à¸à¸±à¸”à¸à¸²à¸£à¹€à¸‚à¹‰à¸²à¸–à¸¶à¸‡à¹„à¸Ÿà¸¥à¹Œ `faces.json`
2. **JSON à¹€à¸«à¸¡à¸²à¸°à¸à¸±à¸š demo** - à¸–à¹‰à¸²à¸•à¹‰à¸­à¸‡à¸à¸²à¸£ production à¸„à¸§à¸£à¹ƒà¸Šà¹‰ database
3. **CORS à¸•à¸±à¹‰à¸‡à¸„à¹ˆà¸²à¹€à¸›à¸´à¸”à¸à¸§à¹‰à¸²à¸‡** - Production à¸„à¸§à¸£à¸£à¸°à¸šà¸¸ origin à¸—à¸µà¹ˆà¸­à¸™à¸¸à¸à¸²à¸•à¹€à¸—à¹ˆà¸²à¸™à¸±à¹‰à¸™

## ğŸ¯ à¸à¸²à¸£à¸›à¸£à¸±à¸šà¹à¸•à¹ˆà¸‡ Threshold

- à¸„à¹ˆà¸² threshold à¸ªà¸¹à¸‡ (0.5-0.6): à¹€à¸‚à¹‰à¸¡à¸‡à¸§à¸”à¸¡à¸²à¸, false positive à¸™à¹‰à¸­à¸¢ à¹à¸•à¹ˆà¸­à¸²à¸ˆ reject à¸„à¸™à¸—à¸µà¹ˆà¸¥à¸‡à¸—à¸°à¹€à¸šà¸µà¸¢à¸™à¹à¸¥à¹‰à¸§
- à¸„à¹ˆà¸² threshold à¸•à¹ˆà¸³ (0.35-0.45): à¸œà¹ˆà¸­à¸™à¸›à¸£à¸™, à¸­à¸²à¸ˆà¸¡à¸µ false positive à¹€à¸à¸´à¹ˆà¸¡à¸‚à¸¶à¹‰à¸™

à¸„à¸§à¸£à¸—à¸”à¸ªà¸­à¸šà¸à¸±à¸šà¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸ˆà¸£à¸´à¸‡à¹€à¸à¸·à¹ˆà¸­à¸«à¸²à¸„à¹ˆà¸²à¸—à¸µà¹ˆà¹€à¸«à¸¡à¸²à¸°à¸ªà¸¡

## ğŸ“ License

MIT License
